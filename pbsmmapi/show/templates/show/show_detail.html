{% extends "base.html" %}
{% load sekizai_tags staticfiles pbsmm_tags %}

{% block content %}
<h1>Show Detail Page - {{ show.title }}</h1>
<h2>THIS IS THE SKELETON TEMPLATE FROM THE PBSMMAPI APP</h2>

<h2>FIELDS</h2>
Some come from PBS MM, others are generated by the back end.  Many won't be needed.
<table width="100%" border="2">
    <tr><th width="30%">Parameter</th><th>Value</th></tr>
    <tr><td>Absolute URL</td><td>{{ show.get_absolute_url }}</td></tr>
    <tr><td>Audience</td><td>{{ show.audience }}</td></tr>
    <tr><td>Available to Public</td><td>{{ show.available_to_public }}</td></tr>
    <tr><td>Can Embed Player</td><td>{{ show.can_embed_player }}</td></tr>
    <tr><td>Description (short)</td><td>{{ show.description_short }}</td></tr>
    <tr><td>Description (long)</td><td>{{ show.description_long }}</td></tr>
    <tr><td>Display Episode Number</td><td>{{ show.display_episode_number }}</td></tr>
    <tr><td>Episode Count</td><td>{{ show.episode_count }}</td></tr>
    <tr><td>Funder Message</td><td>{{ show.funder_message }}</td></tr>
    <tr><td>GA Event</td><td>{{ show.ga_event }}</td></tr>
    <tr><td>GA Page</td><td>{{ show.ga_page }}</td></tr>
    <tr><td>Genre</td><td>{{ show.genre }}</td></tr>
    <tr><td>Hashtag</td><td>{{ show.hashtag }}</td></tr>
    <tr><td>Is Publicly Available? (set in Admin)</td><td>{{ show.is_publicly_available }}</td></tr>
    <tr><td>Language</td><td>{{ show.language }}</td></tr>
    <tr><td>NOLA</td><td>{{ site.nola }}</td></tr>
    <tr><td>Ordinal Season (flag)</td><td>{{ show.ordinal_season }}</td></tr>
    <tr><td>Platforms</td><td>{{ show.platforms }}</td></tr>
    <tr><td>Premiered On</td><td>{{ show.premiered_on }}</td></tr>
    <tr><td>Serializable Value</td><td>{{ show.serializable_value }}</td></tr>
    <tr><td>Slug</td><td>{{ show.slug }}</td></tr>
    <tr><td>Sort Episodes Descending</td><td>{{ show.sort_episodes_descending }}</td></tr>
    <tr><td>Title</td><td>{{ show.title }}</td></tr>
    <tr><td>Title (sortable)</td><td>{{ show.sortable_title }}</td></tr>
</table>

Testing JSON splitter: 
<br>Genre: {{ show.genre }}
<br>Genre title: {{ show.genre|extract_from_json:"title" }}
<br>Platform slug: {{ show.platforms|extract_from_json:"slug" }}

<h3>SEASONS AND EPISODES</h3>

{% if show.seasons.count %}
<table width="100%" border=2>
    <tr style="background-color: #999;">
        <th colspan="3">Season / Episodes</th>
        <th>Admin</th>
        <th># Assets</th>
        <th>Publish Status</th>
    </tr>
    {% for season in show.seasons.all %}
    <tr style="background-color: #ddd;">
        <td colspan="3">Season {{ season.ordinal }}: {{ season.printable_title }}</td>
        <td><a href="/admin/season/pbsmmseason/{{ season.id }}/change/">Admin</a></td>
        <td>&nbsp;{{ season.assets.all|length }}</td>
        <td>{{ season.show_publish_status }}</td>
    </tr>
        {% for episode in season.episodes.all %}
        <tr>
            <td width="5%">&nbsp;</td>
            <td>{{ season.ordinal|stringformat:"02d"}}{{ episode.ordinal|stringformat:"02d"}}</td>
            <td>{{ episode.title }}</td>
            <td><a href="/admin/episode/pbsmmepisode/{{ episode.id }}/change/\">Admin</a></td>
            <td>&nbsp;{{ episode.assets.all|length }}</td>
            <td>{{ episode.show_publish_status }}</td>
        </tr>
        {% endfor %}
        
    {% endfor %}
</table>
{% else %}
<p>There are no seasons</p>
{% endif %}

<h3>SPECIALS</h3>
{% if show.specials.count %}

<table width="100%" border=2>
    <tr style="background-color: #999">
        <th>Special Title</th>
        <th>Admin</th>
        <th># Assets</th>
        <th>Publish Status</th>
    </tr>
    {% for special in show.specials.all %}
    <tr>
        <td>{{ special.title }}</td>
        <td><a href="/admin/episode/pbsmmspecial/{{ special.id }}/change/\">Admin</a></td>
        <td>{{ special.assets.all|length }}</td>
        <td>{{ special.show_publish_status }}</td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>There are no Specials</p>
{% endif %}
<h3>SHOW ASSETS</h3>

{% if show.assets.count %}
<p>The highlighted on is the one that would appear as the default "show.default_asset".
It can be changed in the ShowAsset admin by changing the "OVERRIDE DEFAILT ASSET" to "yes".</p>

<table width="100%" border="2">
    <tr><th>Title</th><th>Type</th><th>Duration</th><th>Admin</th></tr>
    {% for asset in show.assets.all %}
        <tr {% if asset == show.default_asset %}style="background-color: #FF0;"{% endif %}>
            <td>{{ asset.title }}</td>
            <td>{{ asset.object_type }}</td>
            <td>{{ asset.formatted_duration }}</td>
            <td><a href="/admin/show/pbsmmshowasset/{{ asset.id }}/change/">Admin</a></td>
        </tr>
    {% endfor %}
</table>

<h4>Default Asset Player</h4>

{{ show.default_asset.player_code }}
<br/>
<div style="width: 640px; height: 360px;">
{{ show.default_asset.player_code|safe }}
</div>
{% else %}
<p>There are no assets.</p>
{% endif %}

<h3>IMAGES</h3>

Here are the images associated with the Show
I need to create a template tag that can read the stored JSON and return things.
But there are also properties for getting the canonical image.

{{ show.images }}

<h4>Image List</h4>
{% comment %} I'm being lazy and just spitting out the table I made for the admin.  It has been a long day.{% endcomment %}
{{ show.pretty_image_list|safe }}
<br/>
Canonical Image Type Override:  {{ show.canonical_image_type_override }}
<br/>
Canonical Image: <img src="{{ show.canonical_image }}">
{% endblock content %}
